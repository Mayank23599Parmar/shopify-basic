{% if swatch == blank %}
{% else %}
{% assign found_option = false %}
{% assign option_index = -1 %}
{% for option in product.options %}
{% if option == swatch %}
{% assign found_option = true %}
{% assign option_index = forloop.index0 %}
{% endif %}
{% endfor %}
{% if option_index != -1 %}
<div class="swatches">
    <div class="swatch" data-option-index="{{ option_index }}">
        <p class="swatch_title">{{ swatch }}</p>
        {% assign values = '' %}
        {% for variant in product.variants %}
        {% assign value = variant.options[option_index] %}

        {% unless values contains value %}
        {% assign values = values | join: ',' %}
        {% assign values = values | append: ',' | append: value %}
        {% assign values = values | split: ',' %}
        <div data-value="{{ value | escape }}" class="swatch-element {{ value | handle }}">
            <span>
                {{ value | escape }}
            </span>
        </div>
        {% endunless %}
        {% endfor %}
    </div>
</div>
{% endif %}
{% endif %}